# 4. 仿真
## 4.1 仿真流程
- （1）用户首先在“仿真库”处右键，点击“添加”，在弹出的对话框中输入仿真的名称，并选择要对哪一模式进行仿真。
- （2）用户在“仿真库”内选择建立好的仿真，展开菜单，选择“仿真配置”，进行配置，按步骤配置完成后，点击“开始仿真”，以开始仿真。（详见4.2）
- （3）用户在“仿真库”内选择建立好的仿真，展开菜单，选择“仿真过程”或“仿真结果”，可查看仿真的过程及结果。（详见4.3）
## 4.2 仿真配置
对仿真配置的更改，可以点击菜单栏上的保存按钮进行保存。未保存的更改会在关闭页面后遗失。点击“开始仿真”按钮，能够保存当前更改，并启动仿真。
### 4.2.1 模式要素
模式要素配置界面的左侧为泳道图，右侧为模式要素的配置面板。泳道图中的模式要素，和右侧的折叠面板项一一对应。点击泳道图中的任一模式要素，即可在右侧展开对应的折叠面板，对模式要素进行配置。在模式要素配置中，“名称”、“类型”不可更改（是在模式库里配置的）。

数值属性配置：点击“添加数值属性”按钮，添加一项数值属性。首先选择属性的类型，再填写属性值。填写属性值时，可以点击编辑器按钮，使用编辑器编辑。由于代码段也可以作为属性值，在编辑器中，可选择值的类型为“仅执行一次的代码”、“可多次执行的代码”、“普通值”中的一种。

关系属性配置：关系属性主要用于描述两个模式要素之间的关系。点击“添加关系属性”按钮，添加一项关系属性。首先在第一个框中选择属性的类型，再在第二个框中选择一个模式要素。
### 4.2.2 模式实例
模式实例配置界面左边是一颗树，树的节点有两种，一种是“实例”，它是仿真中的一个基本单位，每个实例扮演一个或多个角色，参与到商业模式的流程中。另一种是“组”，它用于管理实例，只有number一个属性，在一个组下的实例和组在仿真中会被创建number个。初始时，树为空，可点击添加实例或添加组按钮来创建，创建的组或实例默认为当前时间，可以进行修改。之后可以右键树中的节点添加子节点或删除当前节点，实例是不能添加子节点的。
当选中树中的某个节点时，在右侧会显示他的基本信息，用户可以进行编辑。大部分属性与4.2.1中的相同，区别在于这一部分编辑针对的是具体的实例。不同的有：
- “关系绑定”：与4.2.1中的模式要素进行绑定，同时会继承数值属性
- “关系属性”：自己为源实例，右边选框为目的实例，目的实例和源实例不能是多对多关系。
### 4.2.3 配置
这一部分是对整个仿真其他参数的配置，默认配置项有最大步长和最长运行时间，用户还可以点击按钮自行添加其他的配置。
## 4.3 仿真过程及结果
### 4.3.1 仿真过程控制
控制栏中的四个按钮，可控制仿真的执行过程。

- 在运行状态下，点击“暂停”按钮，可暂停仿真。
- 在暂停状态下，点击“继续”按钮，可继续执行仿真。
- 在暂停状态下，点击“单步执行”按钮，可单步执行仿真。
- 在运行状态下，点击“停止”按钮，可终止仿真。

打开“自动刷新”开关，可使得进度条总是选中最新步，下方的指标值栏（监视栏）总是显示最新步数的指标数据，仿真数据栏总是显示最新步数的统计数据。

点击进度条中的任何一个柱子，可跳转到该柱子表示的步数，使得下方的指标值栏（监视栏）显示该步数的指标数据，仿真数据栏显示该步数的统计数据。

### 4.3.2 监视（指标）
- （1）添加监视：在指标值栏，点击“+”按钮添加监视。
- （2）查看指标值：在指标值栏，点击某个值，可在小窗口中查看指标值。
### 4.3.3 仿真数据
- （1）图表
在图表中，可以选择产生3种类型的图，分别是柱状图、折线图和饼状图。
柱状图和折线图的X轴固定是step，用户可以自行决定Y轴的数据。当选好图的类型和Y轴数据后，点击创建图表即可。图表的X轴会根据当前选中的step变化（如果选中了step=4,那么X轴将会显示step=0-4的数据）。
饼状图需要选择数据集，选好后点击创建图表，用户可以直观的看到这些数据所占据的比例。
无论的Y轴数据还是数据集，可选的范围都来自左边的监视中有值的监视条目，包括本身是数值的属性（如fund=1000）和运算后是数值的代码（如c=a+b）。
- （2）实例
实例界面会显示在模式实例配置(4.2.2)中添加的所有实例，如果组的number属性不为1，则创建的多个实例的名称为name@0、name@1...。在这个界面，实例的结构进行了扁平化，变成了一个列表。点击左边列表中的某个实例将会在右边显示它的详细信息，这些信息仅供查看，不能够修改。
- （3）活动
活动界面是一个表格，显示了当前step所有在运行的活动
- （4）控制台 
暂未实现